{% extends 'base.html' %} {% block title %}搜索结果 - 提示词管理平台{% endblock
%} {% block styles %}
<style>
  /* 添加容器限制最大宽度 */
  .search-container {
    max-width: 1240px;
    margin: 0 auto;
    padding: 0 15px;
  }

  /* 使用与浏览页面相同的样式 */
  .prompt-list-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    margin: 2rem 0;
  }

  .prompt-list-item {
    background-color: #fff;
    border-radius: 0.5rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .prompt-list-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  }

  .prompt-header {
    padding: 1.25rem;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .prompt-title {
    font-size: 1.25rem;
    margin-bottom: 0;
    color: var(--primary-color);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 70%;
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
  }

  .prompt-body {
    padding: 1.25rem;
  }

  .prompt-body p {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.5;
    margin-bottom: 0;
  }

  .prompt-meta-inline {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .prompt-meta-inline i {
    font-size: 0.9rem;
    color: #6c757d;
  }

  /* 可点击卡片样式 */
  .clickable-card {
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .clickable-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  }

  .clickable-card:active {
    transform: translateY(-1px);
  }

  .prompt-footer {
    padding: 1rem 1.25rem;
    background-color: rgba(0, 0, 0, 0.02);
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .prompt-meta {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 1.5rem;
    font-size: 0.9rem;
    color: #6c757d;
    overflow: visible;
    max-width: 100%;
  }

  .prompt-footer .btn {
    min-width: 120px;
    text-align: center;
    flex-shrink: 0;
  }

  .prompt-meta-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .prompt-tag {
    display: inline-block;
    padding: 0.3rem 0.75rem;
    background-color: var(--light-bg);
    color: var(--text-color);
    border-radius: 30px;
    margin: 0.4rem;
    font-size: 0.85rem;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    transform-origin: center;
  }

  /* 词云效果 - 大小变化 */
  .prompt-tag:nth-child(3n + 1) {
    font-size: 0.75rem;
    padding: 0.25rem 0.6rem;
  }

  .prompt-tag:nth-child(3n + 2) {
    font-size: 0.9rem;
    padding: 0.35rem 0.8rem;
  }

  .prompt-tag:nth-child(3n + 3) {
    font-size: 1rem;
    padding: 0.4rem 0.9rem;
    font-weight: 500;
  }

  /* 词云效果 - 颜色变化 */
  .prompt-tag:nth-child(5n + 1) {
    background-color: rgba(var(--primary-rgb), 0.1);
    color: var(--primary-color);
  }

  .prompt-tag:nth-child(5n + 2) {
    background-color: rgba(var(--success-rgb), 0.1);
    color: var(--success-color);
  }

  .prompt-tag:nth-child(5n + 3) {
    background-color: rgba(var(--info-rgb), 0.1);
    color: var(--info-color);
  }

  .prompt-tag:nth-child(5n + 4) {
    background-color: rgba(var(--warning-rgb), 0.1);
    color: var(--warning-color);
  }

  .prompt-tag:nth-child(5n + 5) {
    background-color: rgba(var(--danger-rgb), 0.1);
    color: var(--danger-color);
  }

  /* 悬浮效果增强 */
  .prompt-tag:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    z-index: 100;
  }
</style>
{% endblock %} {% block content %}
<div class="search-container">
  <div class="row mb-4">
    <div class="col-md-12">
      <div class="d-flex justify-content-between align-items-center">
        <h1 class="mb-0">
          搜索结果 {% if query or selected_tag %}
          <small class="text-muted">
            {% if query %}关键词: "{{ query }}"{% endif %} {% if query and
            selected_tag %} 和 {% endif %} {% if selected_tag %}标签: "{{
            selected_tag }}"{% endif %}
          </small>
          {% endif %}
        </h1>
        {% if session.user_id %}
        <a href="/create-prompt" class="btn btn-primary">
          <i class="bi bi-plus-lg"></i> 创建提示词
        </a>
        {% endif %}
      </div>
      <hr />
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div class="prompt-list-container">
        {% if prompts %} {% for prompt in prompts %}
        <div
          class="prompt-list-item clickable-card"
          data-url="/prompts/{{ prompt.id }}"
        >
          <div class="prompt-header">
            <h2 class="prompt-title">{{ prompt.title }}</h2>
            <span
              class="badge {% if prompt.is_public %}bg-success{% else %}bg-secondary{% endif %}"
            >
              {% if prompt.is_public %}公开{% else %}私有{% endif %}
            </span>
          </div>
          <div class="prompt-body">
            <p>{{ prompt.description or '无描述' }}</p>
            {% if prompt.tags %}
            <div class="mt-3">
              {% for tag in prompt.tags %}
              <a
                href="/search?tag={{ tag.name }}"
                class="prompt-tag"
                onclick="event.stopPropagation()"
                >{{ tag.name }}</a
              >
              {% endfor %}
            </div>
            {% endif %}
          </div>
          <div class="prompt-footer">
            <div class="prompt-meta">
              <div class="prompt-meta-item">
                <i class="bi bi-person-circle text-primary"></i>
                <span class="fw-medium">{{ prompt.username }}</span>
              </div>
              <div class="prompt-meta-item">
                <i class="bi bi-eye"></i>
                <span>{{ prompt.view_count or 0 }} 次浏览</span>
              </div>
              <div class="prompt-meta-item">
                <i class="bi bi-calendar3"></i>
                <span
                  >{{ prompt.created_at[:10] if prompt.created_at else
                  '未知时间' }}</span
                >
              </div>
            </div>
          </div>
        </div>
        {% endfor %} {% else %}
        <div class="col-md-12 text-center py-5">
          <div class="mb-4">
            <i class="bi bi-search" style="font-size: 4rem"></i>
          </div>
          <h3>未找到匹配的提示词</h3>
          <p>尝试更改搜索条件或浏览其他提示词</p>
          <a href="/" class="btn btn-primary mt-3">
            <i class="bi bi-house"></i> 返回首页
          </a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const tagFilters = document.querySelectorAll(".tag-filter");
    const searchForm = document.querySelector("form");

    // 监听标签筛选器变化
    tagFilters.forEach((filter) => {
      filter.addEventListener("change", function () {
        searchForm.submit();
      });
    });

    // 卡片点击事件
    document.querySelectorAll(".clickable-card").forEach((card) => {
      card.addEventListener("click", function (e) {
        // 如果点击的是标签或按钮，不触发卡片点击
        if (
          e.target.closest(".prompt-tag") ||
          e.target.closest("button") ||
          e.target.closest("a")
        ) {
          return;
        }
        window.location.href = this.dataset.url;
      });
    });
  });
</script>
{% endblock %}
